## Аудит

Аудит безопасности является мощным средством обеспечения безопасности любой организации. Аудит может использоваться для различных целей, включая анализ соответствия нормативным требованиям, наблюдение за действиями пользователей и устранение неполадок. Во многих организациях (в том числе нашей) существует строгий набор правил (политик), относящихся к безопасности и конфиденциальности данных. Аудит безопасности может помочь реализации таких политик и подтвердить, что эти политики были реализованы. Кроме того, аудит безопасности необходим для анализа происходящего в системе, чтобы помочь администраторам обнаруживать аномальное поведение, выявлять и устранять недостатки в политиках безопасности и также предотвращать безответственное поведение путем отслеживания важных действий.

### Штатные средства аудита в ОС Windows

Понятие «аудит» в литературе, посвященной Windows включает в себя отчасти ранее рассмотренные понятия «протоколирования», «аудита» и «активного аудита». Различные версии ОС Windows обладают различным набором средств аудита. 

Средства поддержки протоколирования и аудита в ОС Windows:
1.	Security Reference Monitor (SRM) (Монитор безопасности) контролирует доступ процессов к системам, услуги которых они запрашивают. 
2.	Монитор безопасности ОС отвечает за генерацию отчета по аудиту, основываясь на системных списках прав доступа и правилах аудита. 
3.	ОС Windows включает в себя стандартные системы регистрации событий, которые позволяют подробно регистрировать доступ к объектам любого типа (файлы, каталоги, принтеры и т.д.), а также информацию об аутентификации пользователей.
4.	Отчет по аудиту передается в журнал событий (EventLog), который записывает события в файлы журналов. Эта операция называется журналированием событий.

Основные журналы событий:
1.	System (Система) - хранит события операционной системы или ее компонентов, например неудачи при запусках служб или инициализации драйверов, общесистемные сообщения и прочие сообщения, относящиеся к системе в целом. По умолчанию помещается в %SystemRoot%\System32\Config\Sysevent.evt. 
2.	Security (Безопасность) - хранит события, связанные с безопасностью, такие как вход/выход из системы, использование привилегий и обращение к ресурсам. По умолчанию помещается в %SystemRoot%\System32\Config\Secevent.evt.
3.	Application (Приложение) - хранит важные события, связанные с конкретным приложением. Например, ExchangeServer сохраняет события, относящиеся к пересылке почты, в том числе события информационного хранилища, почтовых ящиков и запущенных служб. По умолчанию помещается в %SystemRoot%\System32\Config\Appevent.evt.

Возможные журналы событий:
1.	DirectoryService (Служба каталогов) на контроллерах домена этот журнал хранит события службы каталогов ActiveDirectory, в том числе относящиеся к ее запуску, глобальным каталогам и проверкам целостности. По умолчанию помещается в %SystemRoot%\\System32\Config\Ntds.evt.
2.	DNS Server (DNS-сервер) - на DNS-серверах в этом журнале сохраняются DNS-запросы, ответы и прочие события DNS. По умолчанию помещается в %SystemRoot%\System32\Config\Dnsevent.evt.
3.	FileReplicationService (Служба репликации файлов) - на контроллерах домена и других серверах, использующих репликацию, этот журнал регистрирует действия в системе, связанные с репликацией файлов, в том числе события состояния и управления службой, сканирования данных на системных томах, а также управления наборами репликации. По умолчанию помещается в %SystemRoot%\Sysem32\Config\Ntfrs.evt.

Типы событий
1.	Information (Уведомление) - указывает на возникновение информационного события, обычно связанного с успешным действием;
2.	Warning (Предупреждение) - предупреждение общего характера. Зачастую помогает избежать последующих проблем в системе;
3.	Error (Ошибка) - критическая ошибка, например неудача при запуске службы.

Типы событий аудита
1.	SuccessAudit (Аудит успехов) - успешное выполнение действий, которые вы отслеживаете через аудит, например использование какой-либо привилегии;
2.	Failure Audit (Аудит отказов) - неудачное выполнение действий, которые вы отслеживаете через аудит, например ошибка при входе в систему.

### Ход работы
Проделать следующие действия от имени пользователя с правами администратора.
1.	Для запуска редактора локальной групповой политики (РЛГП) можно ввести в поиск «изменение групповой политики» или в меню запуск «gpedit.msc».
2.	В РЛГП: Конфигурация компьютера – Конфигурация Windows – Параметры безопасности – Конфигурация расширенной политики аудита – «Политики аудита системы – Объект локальной групповой политики». **Прочитать пояснение и предупреждение.**

До включения «расширенной политики аудита» аудит настраивается в разделе:
Конфигурация компьютера – Конфигурация Windows – Параметры безопасности – Локальные политики – Политика аудита

Включение «расширенной политики аудита»:
Конфигурация компьютера – Конфигурация Windows – Параметры безопасности – Локальные политики – Параметры безопасности - Аудит: принудительно переопределяет параметры категории политики аудита параметрами подкатегории политики аудита (ОС Windows Vista или более поздние версии).

3.	В «расширенной политике аудита» разделе «Доступ к объектам» включить «Аудит файловой системы» (Успех и Отказ)
4.	Создать папку в «C:\Temp\» и в ней создать текстовый файл.
5.	Открыть свойства созданной папки и на вкладке «Безопасность» выбрать «Дополнительно».
6.	На вкладке «Аудит» выбрать «Продолжить» (нужны привилегии суперпользователя) и далее «Добавить». Далее «Выберите субъект» и указать «Все» (т.е. для всех пользователей). Опцию «Тип» выбрать «Все», опцию «Применяется к» выбрать «Для этой папки, ее подпапок и файлов». В «Общие разрешения» оставить только «Запись». Применить изменения.
7.	Записать что-нибудь в созданный в п.4 файл.
8.	В журнале «Безопасность» протоколирования событий Windows (панель управления-viev event logs-windows logs-security) найти событие изменения вашего файла. **Показать преподавателю**.

Активный аудит.

9.	Для найденного события изменения файла создать активную задачу (через контекстное меню или через опции инструментального меню). В качестве активного действия выбрать запуск утилиты CMD.EXE.
10.	Записать что-нибудь в созданный в п.4 файл.
11.	Убедиться, что система автоматически реагирует на заданное событие (в данном случае это запуск утилиты cmd.exe). **Показать преподавателю**, что при записи в файл запускается утилита CMD.EXE.